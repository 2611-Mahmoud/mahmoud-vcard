<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dr. Eng. Mahmoud AbouBakr | VCard</title>
  <meta name="description" content="Official vCard of Dr. Eng. Mahmoud AbouBakr, Electrical Consultant and Renewable Energy Expert." />
  <meta name="theme-color" content="#C9A227" />

  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <style>
    body {
      font-family: 'Merriweather', serif;
      margin: 0;
      background: #fff;
      color: #333;
      transition: all 0.3s ease;
      text-align: center;
    }

    .container {
      max-width: 420px;
      margin: 60px auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      padding: 20px;
    }

    img {
      width: 160px;
      height: 160px;
      border-radius: 50%;
      object-fit: cover;
      margin: 10px auto;
      display: block;
    }

    h1 {
      font-size: 1.6rem;
      margin: 10px 0 5px;
      border-bottom: 2px solid #C9A227;
      display: inline-block;
      padding-bottom: 4px;
    }

    h2 {
      font-size: 1rem;
      color: #555;
      margin-bottom: 20px;
    }

    a { color: #C9A227; text-decoration: none; }
    a:hover { color: #a5841f; }

    .button {
      background-color: #C9A227;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      margin: 8px;
      font-size: 0.9rem;
      transition: all 0.3s;
    }
    .button:hover { background-color: #b29222; transform: scale(1.05); }

    .whatsapp-btn {
      background: #25D366;
      color: white;
      display: inline-flex;
      align-items: center;
      border-radius: 25px;
      padding: 8px 16px;
      text-decoration: none;
    }

    .lang-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #C9A227;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 0.8rem;
    }

    footer {
      margin-top: 25px;
      font-size: 0.75rem;
      color: #777;
    }

    /* Contact panel */
    #contactPanel {
      display: none;
      max-width: 420px;
      margin: 40px auto;
      background: #fff;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    input, textarea {
      width: 90%;
      padding: 8px;
      margin: 6px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-family: inherit;
    }
    textarea { resize: vertical; }

    #sendStatus { margin-top: 10px; font-size: 0.85rem; }
  </style>
</head>

<body>
  <button class="lang-toggle" id="langBtn">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>

  <!-- Main Profile -->
  <div class="container" id="mainCard">
    <img src="Mahmoud Elsayed - PIC - 3.jpg" alt="Dr. Eng. Mahmoud AbouBakr" />
    <h1 id="name">Dr. Eng. Mahmoud AbouBakr</h1>
    <h2 id="title">Electrical Consultant | Renewable Energy Expert</h2>

    <p><strong>üìû</strong> <a href="tel:+966563009484" id="phone">+966 56 300 9484</a></p>
    <p><strong>üìß</strong> <a href="mailto:Dr.Eng.mahmoud.Aboubakr@gmail.com" id="email">Dr.Eng.mahmoud.Aboubakr@gmail.com</a></p>
    <p><strong>üîó</strong> <a href="https://www.linkedin.com/in/mahmoud-aboubakr-phd-msc" id="linkedin" target="_blank">LinkedIn Profile</a></p>

    <a class="whatsapp-btn" href="https://wa.me/966563009484" target="_blank">üí¨ WhatsApp</a>
    <br><button class="button" id="contactBtn">Contact</button>

    <div class="qr-container">
      <canvas id="qrCanvas"></canvas>
      <button class="button" onclick="downloadQR()" id="qrBtn">Download QR</button>
    </div>

    <footer id="footer">¬© Dr. Eng. Mahmoud AbouBakr ‚Äì 2025</footer>
  </div>

  <!-- Contact Area -->
  <div id="contactPanel">
    <h2 id="contactTitle">Contact Dr. Mahmoud</h2>
    <div id="authArea">
      <input id="authName" placeholder="Full Name" /><br>
      <input id="authEmail" placeholder="Email" type="email" /><br>
      <input id="authPass" placeholder="Password" type="password" /><br>
      <button class="button" id="registerBtn">Create Account</button>
      <button class="button" id="loginBtn">Login</button>
    </div>

    <div id="messageArea" style="display:none;">
      <input id="msgName" readonly /><br>
      <input id="msgEmail" readonly /><br>
      <textarea id="msgText" rows="5" placeholder="Write your message..."></textarea><br>
      <button class="button" id="sendBtn">Send Message</button>
      <div id="sendStatus"></div>
    </div>

    <button class="button" id="backBtn">‚¨ÖÔ∏è Back</button>
  </div>

  <script>
    const DR_EMAIL = "Dr.Eng.mahmoud.Aboubakr@gmail.com";
    const EMAILJS_SERVICE_ID = "YOUR_SERVICE_ID";
    const EMAILJS_TEMPLATE_ID = "YOUR_TEMPLATE_ID";
    const EMAILJS_PUBLIC_KEY = "YOUR_PUBLIC_KEY";

    // Local user storage helpers
    const getUsers = () => JSON.parse(localStorage.getItem("users") || "[]");
    const saveUsers = (u) => localStorage.setItem("users", JSON.stringify(u));
    const getCurrentUser = () => localStorage.getItem("currentUser");
    const setCurrentUser = (e) => localStorage.setItem("currentUser", e);

    // QR Generation
    function generateQR() {
      const vcard = `BEGIN:VCARD\nVERSION:3.0\nFN:Dr. Eng. Mahmoud AbouBakr\nTEL:+966563009484\nEMAIL:${DR_EMAIL}\nEND:VCARD`;
      QRCode.toCanvas(document.getElementById("qrCanvas"), vcard, { width: 150 });
    }
    function downloadQR() {
      const link = document.createElement('a');
      link.download = 'Dr-Mahmoud-QR.png';
      link.href = document.getElementById('qrCanvas').toDataURL();
      link.click();
    }

    // Register
    document.getElementById("registerBtn").addEventListener("click", () => {
      const name = document.getElementById("authName").value.trim();
      const email = document.getElementById("authEmail").value.trim();
      const pass = document.getElementById("authPass").value.trim();
      if(!name || !email || !pass){ alert(lang==='ar'?'ÿßŸÖŸÑÿ£ ŸÉŸÑ ÿßŸÑÿ≠ŸÇŸàŸÑ':'Fill all fields'); return; }
      let users = getUsers();
      if(users.find(u=>u.email===email)){ alert(lang==='ar'?'ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸàÿ¨ŸàÿØ ÿ®ÿßŸÑŸÅÿπŸÑ':'User exists. Login instead.'); return; }
      users.push({name,email,pass:btoa(pass)});
      saveUsers(users); setCurrentUser(email); showMessageArea();
    });

    // Login
    document.getElementById("loginBtn").addEventListener("click", () => {
      const email = document.getElementById("authEmail").value.trim();
      const pass = document.getElementById("authPass").value.trim();
      const user = getUsers().find(u=>u.email===email && u.pass===btoa(pass));
      if(!user){ alert(lang==='ar'?'ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿØÿÆŸàŸÑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©':'Invalid credentials'); return; }
      setCurrentUser(email); showMessageArea();
    });

    // Display functions
    function showAuthArea(){ document.getElementById('authArea').style.display='block'; document.getElementById('messageArea').style.display='none'; }
    function showMessageArea(){
      const email = getCurrentUser(); if(!email){ showAuthArea(); return; }
      const user = getUsers().find(x=>x.email===email); if(!user){ showAuthArea(); return; }
      document.getElementById('authArea').style.display='none';
      document.getElementById('messageArea').style.display='block';
      document.getElementById('msgName').value = user.name;
      document.getElementById('msgEmail').value = user.email;
    }

    // Send message
    document.getElementById("sendBtn").addEventListener("click", () => {
      const from_name = document.getElementById("msgName").value;
      const from_email = document.getElementById("msgEmail").value;
      const message = document.getElementById("msgText").value.trim();
      const status = document.getElementById("sendStatus");
      if(!message){ alert(lang==='ar'?'ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ÿ£ŸàŸÑÿßŸã':'Please write your message'); return; }

      status.textContent = lang==='ar'?'...ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ':'Sending...';
      if(EMAILJS_PUBLIC_KEY==="YOUR_PUBLIC_KEY"){
        setTimeout(()=>{status.textContent=lang==='ar'?'‚úÖ ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© (Ÿàÿ∂ÿπ ÿßŸÑÿπÿ±ÿ∂).':'‚úÖ Demo: message recorded (EmailJS not configured).';status.style.color='green';document.getElementById('msgText').value='';},800);
        return;
      }

      try {
        emailjs.init(EMAILJS_PUBLIC_KEY);
        emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, { from_name, from_email, message, to_email: DR_EMAIL })
        .then(()=>{ status.textContent=lang==='ar'?'‚úÖ ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ™ŸÉ ÿ•ŸÑŸâ ÿØ. ŸÖÿ≠ŸÖŸàÿØ.':'‚úÖ Your request has been sent to Dr. Mahmoud.'; status.style.color='green'; document.getElementById('msgText').value=''; },
        err=>{ status.textContent='‚ùå Error: ' + err.text; status.style.color='red'; });
      } catch(e){ status.textContent='‚ùå ' + e; }
    });

    // Navigation
    const contactBtn=document.getElementById('contactBtn');
    const mainCard=document.getElementById('mainCard');
    const contactPanel=document.getElementById('contactPanel');
    const backBtn=document.getElementById('backBtn');
    contactBtn.onclick=()=>{mainCard.style.display='none';contactPanel.style.display='block';showAuthArea();applyLang(lang);}
    backBtn.onclick=()=>{mainCard.style.display='block';contactPanel.style.display='none';}

    // Language system
    const langBtn=document.getElementById('langBtn'); let lang='en';
    const texts={
      en:{title:'Electrical Consultant | Renewable Energy Expert',footer:'¬© Dr. Eng. Mahmoud AbouBakr ‚Äì 2025',contact:'Contact Dr. Mahmoud',fill:'Fill all fields'},
      ar:{title:'ÿßÿ≥ÿ™ÿ¥ÿßÿ±Ÿä ŸáŸÜÿØÿ≥ÿ© ŸÉŸáÿ±ÿ®Ÿäÿ© | ÿÆÿ®Ÿäÿ± ŸÅŸä ÿßŸÑÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿ™ÿ¨ÿØÿØÿ©',footer:'¬© ÿØ. ŸÖ. ŸÖÿ≠ŸÖŸàÿØ ÿßÿ®Ÿàÿ®ŸÉÿ± ‚Äì 2025',contact:'ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿØ. ŸÖÿ≠ŸÖŸàÿØ',fill:'ÿßŸÖŸÑÿ£ ŸÉŸÑ ÿßŸÑÿ≠ŸÇŸàŸÑ'}
    };
    function applyLang(l){
      const t=texts[l];
      document.getElementById('title').textContent=t.title;
      document.getElementById('footer').textContent=t.footer;
      document.getElementById('contactTitle').textContent=t.contact;
      document.body.dir=(l==='ar'?'rtl':'ltr');
      langBtn.textContent=(l==='ar'?'üá¨üáß English':'üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©');
    }
    langBtn.onclick=()=>{lang=(lang==='en'?'ar':'en');applyLang(lang);}

    // Init
    window.addEventListener('DOMContentLoaded',()=>{generateQR();applyLang('en');if(getCurrentUser())showMessageArea();});
  </script>
</body>
</html>